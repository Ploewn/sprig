/*
First time? Check out the tutorial game:
https://sprig.hackclub.com/gallery/getting_started

@title: pacman uwu
@author: 
@tags: []
@img: ""
@addedOn: 2024-00-00
*/
var score = 0;
var next = false;
var complete = false;

const nextlvl = tune`
127.11864406779661: G4-127.11864406779661 + D5/127.11864406779661 + C4~127.11864406779661 + E4^127.11864406779661,
127.11864406779661: A5-127.11864406779661 + G5/127.11864406779661 + D4~127.11864406779661 + E4^127.11864406779661,
127.11864406779661: A5-127.11864406779661 + G5/127.11864406779661 + E4^127.11864406779661,
127.11864406779661: C4~127.11864406779661 + E4^127.11864406779661,
127.11864406779661: E4^127.11864406779661,
127.11864406779661: B5/127.11864406779661 + D4~127.11864406779661 + E4^127.11864406779661,
3305.084745762712`;
const walk1 = tune`
500: C4~500,
15500`;
const caught1 = tune`
230.76923076923077: C5/230.76923076923077 + C4~230.76923076923077,
230.76923076923077: B5/230.76923076923077 + D4~230.76923076923077,
230.76923076923077: B5/230.76923076923077 + C4~230.76923076923077,
6692.307692307692`;
const bgm1 = tune`
142.85714285714286: C4/142.85714285714286 + A5~142.85714285714286,
142.85714285714286: C5/142.85714285714286,
142.85714285714286: G4/142.85714285714286,
142.85714285714286: E4/142.85714285714286,
142.85714285714286: C5/142.85714285714286 + A5~142.85714285714286,
142.85714285714286: G4/142.85714285714286,
142.85714285714286: E4/142.85714285714286,
142.85714285714286,
142.85714285714286: D4/142.85714285714286 + A5~142.85714285714286,
142.85714285714286: D5/142.85714285714286,
142.85714285714286: G4/142.85714285714286,
142.85714285714286: F4/142.85714285714286,
142.85714285714286: D5/142.85714285714286 + A5~142.85714285714286,
142.85714285714286: G4/142.85714285714286,
142.85714285714286: F4/142.85714285714286,
142.85714285714286,
142.85714285714286: C4/142.85714285714286 + A5~142.85714285714286,
142.85714285714286: C5/142.85714285714286,
142.85714285714286: G4/142.85714285714286,
142.85714285714286: E4/142.85714285714286,
142.85714285714286: C5/142.85714285714286 + A5~142.85714285714286,
142.85714285714286: G4/142.85714285714286,
142.85714285714286: E4/142.85714285714286,
142.85714285714286,
142.85714285714286: F4/142.85714285714286 + A5~142.85714285714286,
142.85714285714286: G4/142.85714285714286,
142.85714285714286: G4/142.85714285714286,
142.85714285714286: A4/142.85714285714286,
142.85714285714286: A4/142.85714285714286 + A5~142.85714285714286,
142.85714285714286: B4/142.85714285714286,
142.85714285714286: C5/142.85714285714286,
142.85714285714286`;
const bgm2 = tune`
250: A4/250 + C4^250 + C5-250 + A5~250,
250: A4/250 + C4^250 + C5-250 + A5~250,
250: F4/250,
250: C5/250 + C4^250,
250: D5/250 + C4^250 + G5-250 + B5~250,
250: G4-250,
250: F5/250 + C4^250,
250: F5/250 + C4^250 + A5~250,
250: F5/250 + A5~250,
250: E5/250 + C4^250,
250: G4/250 + C4^250,
250: E5/250 + G5~250,
250: D5/250 + C4^250,
250: D5/250 + C4^250,
250: D5/250 + A5~250,
250: C5/250 + C4^250 + A5~250,
250: C5/250 + C4^250,
250: D4/250 + F4-250,
250: C5/250 + C4^250 + G5~250,
250: B4/250 + C4^250,
250: B4/250,
250: A4/250 + C4^250 + E5-250 + A5~250,
250: C4^250 + A5~250,
250: B4/250,
250: C4^250,
250: E5/250 + C4^250 + F4-250 + G5~250,
250,
250: C5/250 + C4^250,
250: C4^250 + A5~250,
250: A4/250 + A5~250,
250: D4/250 + C4^250 + F4-250,
250: C5/250 + C4^250`;
const yummycaught = tune`
329.6703296703297: C4~329.6703296703297 + B4/329.6703296703297,
329.6703296703297: B5/329.6703296703297 + C4~329.6703296703297,
329.6703296703297: B5/329.6703296703297,
9560.439560439561`;
const congrats = tune`
107.52688172043011,
107.52688172043011: C4/107.52688172043011 + D4~107.52688172043011,
107.52688172043011: D4/107.52688172043011 + E4~107.52688172043011,
107.52688172043011: D4/107.52688172043011 + F4~107.52688172043011,
107.52688172043011: D4/107.52688172043011 + E4/107.52688172043011 + G4~107.52688172043011,
107.52688172043011: E4/107.52688172043011 + A4~107.52688172043011,
107.52688172043011: E4/107.52688172043011 + F4/107.52688172043011 + A4~107.52688172043011 + B4~107.52688172043011,
107.52688172043011: F4/107.52688172043011 + B4~107.52688172043011,
107.52688172043011: F4/107.52688172043011 + G4/107.52688172043011 + B4~107.52688172043011 + C5~107.52688172043011,
107.52688172043011: G4/107.52688172043011 + C5~107.52688172043011,
107.52688172043011: A4/107.52688172043011 + C5~107.52688172043011 + D5~107.52688172043011,
107.52688172043011: A4/107.52688172043011 + B4/107.52688172043011 + D5~107.52688172043011,
107.52688172043011: B4/107.52688172043011 + C5/107.52688172043011 + E5~107.52688172043011,
107.52688172043011: C5/107.52688172043011 + E5~107.52688172043011 + F5~107.52688172043011,
107.52688172043011: D5/107.52688172043011 + F5~107.52688172043011,
107.52688172043011: E5/107.52688172043011 + F5~107.52688172043011 + G5~107.52688172043011,
107.52688172043011: E5/107.52688172043011 + F5/107.52688172043011 + G5~107.52688172043011,
107.52688172043011: F5/107.52688172043011 + A5~107.52688172043011,
107.52688172043011: F5/107.52688172043011 + G5/107.52688172043011 + A5~107.52688172043011,
107.52688172043011: G5/107.52688172043011 + B5~107.52688172043011,
107.52688172043011: G5/107.52688172043011 + A5/107.52688172043011 + B5~107.52688172043011,
107.52688172043011: A5/107.52688172043011 + B5~107.52688172043011,
107.52688172043011: B5/107.52688172043011,
107.52688172043011: B5/107.52688172043011,
322.58064516129036,
107.52688172043011: C4/107.52688172043011 + F4-107.52688172043011,
107.52688172043011: G4-107.52688172043011,
107.52688172043011: C4/107.52688172043011,
107.52688172043011: F4-107.52688172043011,
107.52688172043011`;
const player = "p";
const wall = 'w';
const yummy = 'y';
const yes = 's'
const centerx = 16
const centery = 12



setLegend(
  [ player, bitmap`
....CCC.........
....C66.........
.....66.........
....6666........
....6666........
....66666.......
....660606......
.00006666660000.
....6666666.....
.....6606606....
......6600666...
.......6666666..
........66666660
........06666600
........0..0....
........0..0....` ],
  [ yummy, bitmap`
.....111111.....
...1122222211...
.11222222222211.
1122222992222211
1112222222222111
1221222222221221
1222111111112221
1222222222222221
1222222222222221
1222222222222221
1222222222222221
1222222222222221
1222222222222221
1122222222222211
..112222222211..
...1111111111...`],
  [ wall, bitmap`
0000000000000000
0LLLL0LLLLLL0LL0
0111L01110000L10
0111L06660660L10
0111L011100F0L10
0000000000000000
0FF6666666666660
0F66666666666660
0666666666666660
0666666666666660
0666666666666660
0666666666666660
0666660606063360
06666606060633F0
0666666666666FF0
0000000000000000`],
  [ yes, bitmap`
.......00.......
......0FF0......
......0660......
......0660......
.....0F7670.....
.....0F7670.....
.....0F6660.....
0000066666600000
00FFF66777666600
.00F66666666600.
...00F6666600...
....0F666660....
...0F66006660...
...0F60..0660...
..0F60...06660..
..000.....0000..`],
);

setSolids([player, wall])

let level = 1;
const levels = [map`...`,map`
wwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww
wp......w.w...w...w.....w......w
wwwwwww.w.w.w.w.w.w.www.w.wwww.w
w.....w.w...w...w.w.w...w.w....w
wwwww.w.ww.wwwwww.w.www.w.w.wwww
w...........w.....w.....w.w..w.w
wwwwwwwwwww...w.w.....www.wwww.w
w.w.....w.wwwwwww.www...w...w..w
w.w.www.w.ww....w.w.w.wwwww...ww
w.w.w...w.w..ww.w.w.w.w...ww.www
w.w.w.www.w.ww....w.w...w....w.w
w.w.w........wwwwww.w.wwwwww.w.w
w.w.wwwwwwww.w......w.w..w.....w
w.w....w.w.w.w.w.wwwwwww.wwww.ww
w.wwww.w.w.w...w....w..w......ww
w.w....w.w.wwwwwwwwww.ww.wwwwwww
w...wwww.w..ww...w..w..w.......w
w.w........ww..w.w.ww.wwwww.ww.w
w.wwwwww.wwwww.www..w........w.w
w....w...........w..wwwwwwwwww.w
wwww.w.www.wwwww.ww.w.w...w....w
wyw..w..w....w.w......ww.ww.ww.w
w.w.ww.wwwwwww.w.w.w......w....w
w....w..w....w...w.wwwwww...ww.w
wwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww`, map`
wwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww
wp........w.wwwwwwwwwwww.....w.w
wwwwwwwww.w..............w.www.w
w.www...w.w.wwwwwwwww.wwwwww.w.w
w.....w.w.w.........w.w....w.w.w
w.wwwww.w.wwwwwwwww.w.w.ww.w.w.w
w...w...............w.w.w..w.w.w
www.wwwww.w.wwwww.w.w...w.ww...w
w.w.w.....w.w.....w.w.w.w..w.wyw
w.w.w.wwwww.w.wwwww.w.w.w.ww.www
w.w.w.w..w.....w....w.w.w.ww...w
w.w...w..w.www.wwwwwwww.w.wwww.w
w.ww.www.w.w.w.w........w.w.w..w
w.w..w.....w.w.wwwwwww.ww.w.w.ww
w.wwww.www...........w.w..w...ww
w....w.w...wwwwwwwww.w.wwwwww.ww
w.ww...w.www.....w...w.w......ww
w....www.....w.w.www...w.wwww.ww
w.wwwww...wwwwww.w...w......w.ww
w..w....w.w....w.wwwwwwww.w.w.ww
w.wwwwwww.w.ww..........w.w.w.ww
w.........wwwwwwwwwwwww.w...w.ww
w.wwwwwwwww.............w.www.ww
w........w..wwwwwwwwwww.w.....ww
wwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww`, map`
wwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww
ww.............................w
w.w.wwwwwwwwwwwwwwwwwwwwwwww.w.w
w..........................w.w.w
w.w.w.ww.wwwwwwwwwwwwwwwww.w.w.w
w.w.w.w...........www....w.w.w.w
w.w.w.w.wwwwwwwww.....wwww.w.w.w
w.w.w.w.........w.www....w.w.w.w
w.w.w.w.wwwwwww.www.wwwwww.w.w.w
w.w.w.w.w................w.w.w.w
w.w.w.w.w.wwwwwwwww.wwwwww.w.w.w
w.w.w.w.w.........w.w......w.w.w
w.w.w.w.wwwwwwwww.w.wwwwww.w.w.w
w.w.w.w.w.........w...w....w.w.w
w.w.w.w.w.wwwwwwwww.w.wwww.w.w.w
w.w.w.w.w.........w.w...yw.w.w.w
w.w.w.w.wwwwwwwwwwwwwwwwww.w.w.w
w.w.w.w....................w.w.w
w.w.w.wwwwwwwwwwwwwwwwwwww.w.w.w
w.w.w........................w.w
w.w.wwwwwwwwwwwwwwwwwwwwwww..w.w
w.w.........................ww.w
w.wwwwwwwwwwwwwwwwwwwwwwwwwwww.w
w.............................pw
wwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww`, map`
wwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww
wp...w..w......................w
wwww.w.ww.wwwwwww.wwwwwwwwwwww.w
w.yw.w.w........w......w.....w.w
w.ww.w.wwww.w.w.www.ww.www.w.w.w
w.w..w......w.w.w....w.....w.w.w
w.ww.wwwwwwww.w.ww.w.w.www.w.w.w
w..w..........w..w.w...w...www.w
w.ww.wwwww.w.ww.ww.wwwww.w.....w
w.w.....w..w.ww.w........w.ww.ww
w.wwww.www.w.wwwwwwwwwwwwwwww.ww
w....w...w.w............w.....ww
w.wwwwww.w...wwwwwwwwwwww.wwwwww
w.w....w.wwwww..........w....w.w
w.w.ww.w.w.w.w.wwwwwwww.wwww.w.w
w.w.w....w.w.w.w.w....w......w.w
w.w.wwww...w.w.w...w.wwwww.w.w.w
w.w.ww....ww...w.www.ww..w.w...w
w.w.ww.w.ww...ww.w.........wwwww
w.w....w.wwwwww..w.ww..www.....w
w.wwww.w.w.ww...ww.w..ww.wwwww.w
w.w......w....w..w...ww.....w..w
w.wwwwwwwwwwwwww.wwwww..wwwwww.w
w....................w.........w
wwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww`]

playTune(bgm2, Infinity)
const playback = playTune(bgm2, Infinity)
setMap(levels[level])

setPushables({
  [ player ]: []
})

onInput("w", () => {
  if (!next) {
    getFirst(player).y += -1
    playTune(walk1)
  }
})
onInput("a", () => {
  if (!next) {
    getFirst(player).x += -1
    playTune(walk1)
  }
})
onInput("s", () => {
  if (!next) {
    getFirst(player).y += 1
    playTune(walk1)
  }
})
onInput("d", () => {
  if (!next) {
    getFirst(player).x += 1
    playTune(walk1)
  }
})
onInput("l", () => {
  if (next) {
    level++
    clearText()

    if (level == levels.length) {
      
      playTune(congrats)
      addText("YOU FINISHED!", {x: 3, y: 6, color: color `3`});
      complete = true; 
      
    } else {
      
      setMap(levels[level])
      next = false
      playTune(nextlvl)
    }
  }
})
onInput("k", () => { 
  setMap(levels[level])
})

afterInput(() => {
  delyummy()
})

function delyummy() {
  if (!next) {
    
  let mc = getFirst(player)
  let yummySprite = getFirst(yummy)
    if (yummySprite.x === mc.x && yummySprite.y === mc.y) {
        playTune(yummycaught)
        yummySprite.remove()
        next = true
        addText("Press L to continue", {x: 1, y: 7, color: color `0`})
        playTune(caught1)
    }
  }
}

